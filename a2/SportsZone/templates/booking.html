{% extends "base.html" %}
{% block title %}Booking History · SportsZone{% endblock %}

{% block extra_css %}
<style>
  /* ===== scope everything to this page ===== */
  .bookings-page { padding-top: .75rem; }

  .bookings-page .page-title{
    font-weight: 800; color: #004a46; margin-bottom: 1rem;
  }

  /* grid cards */
  .bookings-page .booking-card{
    border: 1px solid rgba(0,0,0,.05);
    border-radius: 16px;
    overflow: hidden;
    background: #ffffff;
    box-shadow: 0 6px 16px rgba(0,0,0,.06);
    transition: transform .18s ease, box-shadow .18s ease;
  }
  .bookings-page .booking-card:hover{
    transform: translateY(-3px);
    box-shadow: 0 12px 28px rgba(0,0,0,.12);
  }

  /* left thumb */
  .bookings-page .thumb-wrap{
    position: relative; min-height: 180px; background: #eaf7f5;
  }
  .bookings-page .thumb{
    position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover;
  }

  /* right body */
  .bookings-page .body{
    padding: 1rem 1.25rem 1.25rem;
    display: flex; flex-direction: column; height: 100%;
  }
  .bookings-page .title{
    font-size: 1.15rem; font-weight: 800; margin: 0; color: #0f2f28;
  }
  .bookings-page .meta{
    margin-top: .35rem; color: #6b7280; font-size: .92rem;
  }
  .bookings-page .meta b{ color:#0f2f28; }
  .bookings-page .spacer{ flex: 1 1 auto; }
  .bookings-page .actions .btn{
    border-radius: 12px; font-weight: 600;
  }
  .bookings-page .btn-primary{
    background:#00bfa6; border:none;
  }
  .bookings-page .btn-primary:hover{ background:#009e8a; }

  /* sport badge */
  .bookings-page .sport-badge{
    margin-left:.5rem; font-weight:700;
    text-transform: lowercase;
  }

  /* fallback thumbnail (first letter) */
  .bookings-page .thumb-fallback{
    position:absolute; inset:0; display:grid; place-items:center;
    font-weight:800; font-size:2.2rem; color:#0f2f28;
    background: linear-gradient(135deg, #c7f7ef, #a8efe6);
  }

  /* responsive tweaks */
  @media (max-width: 767px){
    .bookings-page .thumb-wrap{ min-height: 160px; }
    .bookings-page .body{ padding: .9rem 1rem 1rem; }
  }
</style>
{% endblock %}

{% block body %}
<div class="bookings-page">
  <h1 class="page-title">Your Bookings</h1>

  {% if orders and orders|length > 0 %}
    <div class="row g-3">
      {% set color_map = {
        'football':'primary','Football':'primary',
        'basketball':'warning','Basketball':'warning',
        'cricket':'success','Cricket':'success',
        'tennis':'secondary','Tennis':'secondary'
      } %}

      {% for o in orders %}
        <div class="col-12">
          <article class="booking-card">
            <div class="row g-0 align-items-stretch">
              <!-- thumbnail -->
              <div class="col-12 col-md-3">
                <div class="thumb-wrap">
                  {% if o.image %}
                    <img class="thumb" src="{{ url_for('static', filename='img/' ~ o.image) }}" alt="{{ o.event_title }}">
                  {% else %}
                    <div class="thumb-fallback">{{ (o.event_title or 'E')[:1] }}</div>
                  {% endif %}
                </div>
              </div>

              <!-- content -->
              <div class="col-12 col-md-9">
                <div class="body">
                  <div class="d-flex align-items-start flex-wrap gap-2">
                    <h2 class="title">{{ o.event_title }}</h2>
                    <span class="badge text-bg-{{ color_map.get(o.sport, 'secondary') }} sport-badge">
                      {{ o.sport or 'event' }}
                    </span>
                  </div>

                  <div class="meta">
                    <div>Booked on: <b>{{ o.booked_at }}</b></div>
                    <div>
                      Order ID: <b>{{ o.order_code }}</b>
                      {% if o.quantity %} · Qty: <b>{{ o.quantity }}</b>{% endif %}
                    </div>
                  </div>

                  <div class="spacer"></div>

                  <div class="actions d-flex gap-2">
                    <a href="{{ url_for('main.view_event', event_id=o.event_id) }}" class="btn btn-primary btn-sm">
                      View Event
                    </a>
                    {# You can add a cancel button later:
                    <form method="POST" action="{{ url_for('main.delete_booking', booking_id=o.order_code.split('-')[-1]|int) }}">
                      <button class="btn btn-outline-secondary btn-sm">Cancel</button>
                    </form>
                    #}
                  </div>
                </div>
              </div>
            </div>
          </article>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info">
      You haven’t booked any events yet.
      <a href="{{ url_for('main.index') }}" class="alert-link">Browse events</a>.
    </div>
  {% endif %}
</div>
{% endblock %}
