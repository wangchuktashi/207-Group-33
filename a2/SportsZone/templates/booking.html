{% extends "base.html" %}
{% block title %}Booking History · SportsZone{% endblock %}


{% block body %}
<div class="bookings-page">
  <h1 class="page-title">Your Bookings</h1>

  {% if orders and orders|length > 0 %}
    <div class="row g-3">
      {% set color_map = {
        'football':'primary','Football':'primary',
        'basketball':'warning','Basketball':'warning',
        'cricket':'success','Cricket':'success',
        'tennis':'secondary','Tennis':'secondary'
      } %}

      {% for o in orders %}
        <div class="col-12">
          <article class="booking-card">
            <div class="row g-0 align-items-stretch">
              <!-- thumbnail -->
              <div class="col-12 col-md-3">
                <div class="thumb-wrap">
                  {% if o.image %}
                    <img class="thumb" src="{{ url_for('static', filename='img/' ~ o.image) }}" alt="{{ o.event_title }}">
                  {% else %}
                    <div class="thumb-fallback">{{ (o.event_title or 'E')[:1] }}</div>
                  {% endif %}
                </div>
              </div>

              <!-- content -->
              <div class="col-12 col-md-9">
                <div class="body">
                  <div class="d-flex align-items-start flex-wrap gap-2">
                    <h2 class="title">{{ o.event_title }}</h2>
                    <span class="badge text-bg-{{ color_map.get(o.sport, 'secondary') }} sport-badge">
                      {{ o.sport or 'event' }}
                    </span>
                  </div>

                  <div class="meta">
                    <div>Booked on: <b>{{ o.booked_at }}</b></div>
                    <div>
                      Order ID: <b>{{ o.order_code }}</b>
                      {% if o.quantity %} · Qty: <b>{{ o.quantity }}</b>{% endif %}
                    </div>
                  </div>

                  <div class="spacer"></div>

                  <div class="actions d-flex gap-2">
                    <a href="{{ url_for('main.view_event', event_id=o.event_id) }}" class="btn btn-primary btn-sm">
                      View Event
                    </a>
                    {# You can add a cancel button later:
                    <form method="POST" action="{{ url_for('main.delete_booking', booking_id=o.order_code.split('-')[-1]|int) }}">
                      <button class="btn btn-outline-secondary btn-sm">Cancel</button>
                    </form>
                    #}
                  </div>
                </div>
              </div>
            </div>
          </article>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info">
      You haven’t booked any events yet.
      <a href="{{ url_for('main.index') }}" class="alert-link">Browse events</a>.
    </div>
  {% endif %}
</div>
{% endblock %}
